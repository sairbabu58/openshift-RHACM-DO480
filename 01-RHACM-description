# OpenShift Advance Cluster Management RHACM DO480

https://access.redhat.com/documentation/en-us/red_hat_advanced_cluster_management_for_kubernetes/2.7

Chapter-01:

# Hub cluster (Main cluster where you can manager other k8s or openshift cluster)
# Manage cluster (other k8s or openshift cluster managed by Hub cluster)

# Once ACM istallation is done, it will create some namespaces on Hub Cluster
  > open-cluster-management                 (content main features like; ACM web-console, application search engine, deploy & manage lifecycle of cluster)
  > open-cluster-management-hub             (content the deployments that receive data from the managed clusters)
  > open-cluster-management-observability   (content all the thanos deployment that store, create & visualize the observability. the namespace on present if you enable the RHACM obeservability engine)
  
# Once Managed cluster is added to Hub cluster, it will create some namespaces on Managed cluster
Agent lists:
  > theklusterletagent
  > thesearchengineadd-on
  > the add-on for managing application deployments from RHACM
  > the add-on for applying policies
  > theadd-onfortheobservabilitycomponents

Namespace lists:
  > open-cluster-management-agent                       (contains the deployments for the klusterlet agent)
  > open-cluster-management-agent-addon                 (contains the application's deployments,s earch engine, and policies engines)
  > open-cluster-management-agent-addon-observability   (contains the observability engine's deployments)







Chapter-02: 

1) Search bar
2) Cluster sets
3) Access Controlr for RHACM
4) Role-based Access Control
5) Identity Management 

Infrastructure Tab:
------------------

  > Creating or upgrading a cluster in many different public cloud providers. Importing an existing cluster to the RHACM hub cluster so that you can manage it.
  > Manually scaling the clusters, or enabling autoscaling. The process of resizing a cluster is different if you created the cluster by using RHACM, or if the cluster already existed and you imported it to RHACM.
  > Using RHACM features such as cluster sets, cluster pools, and discovering clusters.
  
RBAC:
-----

open-cluster-management: cluster-manager-admin ==> RHACM super user, with full access. Can create a ManagedCluster resource.

open-cluster-management: admin:managed_cluster_name ==> RHACM administrator access to the ManagedCluster resource named managed_cluster_name.

open-cluster-management: view:managed_cluster_name ==> RHACM view access to the ManagedCluster resource named managed_cluster_name.

open-cluster-management: managedclusterset:admin: managed_clusterset_name ==> RHACM administrator access to the ManagedClusterSet resource named managed_clusterset_name.

open-cluster-management: managedclusterset:view: managed_clusterset_name ==> RHACM view access to the ManagedClusterSet resource named managed_clusterset_name.

open-cluster-management: subscription-admin ==> Can create Git subscriptions that deploy Kubernetes resources YAML files to multiple namespaces.


RHACM also supports the following default RHOCP roles:
-----------------------------------------------------
cluster-admin
admin
edit
view

Pratical:
--------
1) Search bar
2) Cluster sets (prod, stage)
3) Assign RBAC/role to group, who can manage which cluster (prod, stage)
4) IDM configuration, User, groups (optional not covering this chapter)










Chapter-03: Deploying and Managing Policies for RHACM

1) Governance Policies
2) Governance Dashboard
3) Stable and Community Policies
4) 
5)

Policy 
  status:
   > Enable
   > Disable
  Remediation:
   > Inform
   > Enforce
   
Policy Components:
  > Policy (Kind)
  > ConfigurationPolicy (Configuration like, create NS, Subscription, OperatorGroup, all types oc Kind resources)
  > PlacementBinding (Ref PlacementRules)
  > PlacementRules (Match cluster selector/name)
  

# Integration of other Policy Engines with RHACM
  1) Open Policy Agent (OPA)
  2) OPA Gatekeeper

# OPA Gatekeeper Integration with RHACM
  1) Install Gatekeeper Operator
  2) Deploy Gatekeeper Policy

https://github.com/stolostron/policy-collection/blob/main/community/CM-Configuration-Management/policy-gatekeeper-sample.yaml
https://access.redhat.com/documentation/en-us/red_hat_advanced_cluster_management_for_kubernetes/2.4/html-single/governance/index#managing-gatekeeper-operator-policies

# GateKeeper Policy example
    1) We can create policy it will block container image if its latest version
    $ oc apply -f httpd-latest.yaml (blocked. not allowed to create)
    $ oc apply -f httpd-v1.2-4.yaml (Allowed. allowed to create)
  
  








Chapter:04 Installing and Customizing the RHACM Observability Stack (Grafana Dashboard on RHACM)

https://access.redhat.com/documentation/en-us/red_hat_advanced_cluster_management_for_kubernetes/2.4/html-single/observability/index#doc-wrapper


  1) Configure Observability Stack (Default its not enabled)
  2) Monitoring stack
  3) Grafana dashboard
  4) Centralized Dashboard
  5) Installed on Hub Cluster
  6) Require some storage 
  7) Create namespace for Observability Stack (open-cluster-management- observability)
  8) Create a secret (secretname: multiclusterhub-operator-pull-secret in NS: open-cluster-management- observability)
  9) You can extract above secret from (NS: open-cluster-management or openshift-config // secretname: pull-secret)
  10) Follow the RHACM Book Chapter-04 for above configuration
  11) Object storage is require
  12) Disabled Observability Stack (Chapter-04 )


# Customizing Observability
  1) Customizing Grafana dashboard
  2) Prometheus Custom query PROMQL language
  3) Alerts
  4) Alerting rules










Chapter-05: (Deploying Applications Across Multiple Clusters with RHACM)
  
  1) Deploy application on multiple managed cluster
  2) GitOps concept 
  3) Kustomize 
  
# Customizing Resources with Kustomize for RHACM
  base
    deployment.yaml
    service.yaml
    route.yaml
    kustomization.yaml
  overlays
    dev
      kustomization.yaml
    prod
      kustomization.yaml
      pvc.yaml
  
  
  
  
  








Chapter-06: Install and Configure RedHat Quay



  
  
  
  
  
  
  
  
  
  
  
  

  
